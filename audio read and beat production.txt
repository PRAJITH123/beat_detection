import librosa
import IPython.display as ipd
#help(librosa.beat)
print(format('.............This is a program used for beat detection................','^40'))
#reding the audio
time_series , sample_rate = librosa.load('C:\\Users\\Prajith V\\Downloads\\beat_detection_sample.wav')

#finding the beat location
bpm , beat_locations = librosa.beat.beat_track(y = time_series , sr = sample_rate)
print(bpm)
print(beat_locations)

#applying clicks in the beat locations
clicks = librosa.clicks(beat_locations, sr=sample_rate, length=len(time_series))

#producing the clicks_applyed audio
ipd.Audio(time_series+clicks,rate=sample_rate)
print()
##################################################################
#this code works in anaconda

import IPython.display as ipd
import librosa
#import soundfile  this does not work in anaconda


#help(librosa.beat)
print(format('.............This is a program used for beat detection................','^40'))

array , sample_rate = librosa.load('C:\\Temp\\au.mp3')


bpm , beat_locations = librosa.beat.beat_track(y = array , sr = sample_rate)

clicks = librosa.clicks(beat_locations, sr=sample_rate, length=len(array))
ipd.Audio(array+clicks,rate=sample_rate)


#librosa.output.write_wav('au.wav'+,time_series,, norm=False)
#help(librosa.output.write_wav)
#help(soundfile.write)


#to output a audio file
#soundfile.write('C:\\Temp\\d3.wav',array,sample_rate)
#this part not able to execute because unable to import sounfile module

"""data = np.random.uniform(-1,1,44100) # 44100 random samples between -1 and 1
scaled = np.int16(data/np.max(np.abs(data)) * 32767)
write('time_series', 44100, scaled)"""
print(beat_locations)

print(array)

print(bpm)

#this part is not used now , it is used after getting audio and video ready for merging
#subprocess.call('ffmpeg -i C:\\Temp\\vi.mp4 -i C:\\Temp\\au.mp3 -c:v copy -c:a copy pv4.mp4',shell=True)
#print('Muxing Done')


